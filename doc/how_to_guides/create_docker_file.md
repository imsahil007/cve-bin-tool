# How to create a Docker image for CVE Binary Tool?
Docker images can be very helpful. They provide a convenient way to package up applications and preconfigured environments, which you can use privately or share publicly with other Docker users.

We are going to create a Dockerfile of cve_bin_tool for 
demonstration purpose. You can use the same recipe to create your custom Docker image.


## Create a Dockerfile

To create your Docker image, we will have to first create a Dockerfile in the root of the repository which will contain the necessary information to create the environment.  

Start by setting the Python base image for our container, which for this example will be the `python:3.8-slim-buster`.  
You can choose whatever suits you the best. Some Python base images can be found [here](https://hub.docker.com/_/python).    

```Dockerfile
FROM python:3.8-slim-buster
```

Add some Python environment variables to get rid of .pyc generation and to turn off buffering. (Optional)
```Dockerfile
# Keeps Python from generating .pyc files in the container
ENV PYTHONDONTWRITEBYTECODE=1

# Turns off buffering for easier container logging
ENV PYTHONUNBUFFERED=1
```

Now, set the working directory for our project inside our Docker container. Let's name it 'cve_bin_tool'.
```Dockerfile
WORKDIR /cve_bin_tool
```

Install dependencies - The packages you need to run CVE Binary Tool are listed in the requirements.txt file in the main cve-bin-tool directory. You can install all of them using the following pip command.
```Dockerfile
RUN python -m pip install -r requirements.txt
```
Copy the project inside our Docker container. This will copy all the contents of cve_bin_tool inside our Docker image.
```Dockerfile
COPY . .
```

Let's create a non-root user for our image and give it the necessary permissions to work with.
```Dockerfile
# Creates a non-root user and adds permission to access the /cve_bin_tool folder
RUN useradd cvebintooluser && chown -R cvebintooluser /cve_bin_tool
USER cvebintooluser 
```
Finally, let's run CVE Binary Tool to fetch CVE data from NVD.
```Dockerfile
RUN python -m cve_bin_tool.cli 
```
Alternatively, you can setup your Docker container to fetch the NVD Data every time you open your Docker image by using:
```Dockerfile
CMD ["python","-m","cve_bin_tool.cli","scan_path"]
```

And if you want to do everything manually, you can always use this to access your Docker image.
```Dockerfile
CMD ["/bin/bash"]
```

Your Dockerfile will look something like this:
```Dockerfile
FROM python:3.8-slim-buster

# Keeps Python from generating .pyc files in the container
ENV PYTHONDONTWRITEBYTECODE=1

# Turns off buffering for easier container logging
ENV PYTHONUNBUFFERED=1

WORKDIR /cve_bin_tool

# Install cve-bin-tool requirements
COPY requirements.txt requirements.txt
RUN python -m pip install -r requirements.txt

# Copies cve_bin_tool directory to container
COPY . .

# Creates a non-root user and adds permission to access the /cve_bin_tool folder
RUN useradd cvebintooluser && chown -R cvebintooluser /cve_bin_tool
USER cvebintooluser

RUN python -m cve_bin_tool.cli 

CMD ["/bin/bash"]

```
## How to build the Docker image
To build the image simply run 
```
docker build ${cve-bin-tool} -t "cve_bin_tool"
```
Here `${cve-bin-tool}` is the directory path to cve_bin_tool and "cve_bin_tool" is the name of your Docker image.

## How to use the Docker image
If you want to mount a directory to your Docker image while initializing it, simply use:
```
docker run -it -v ${directory_to_scan}:${directory_in_docker} cve_bin_tool
```
Here `${directory_to_scan}` is the path to the directory on your host machine which you want to scan.
And `${directory_in_docker}` is the path in the Docker image where you mount the above directory.

The -it flag tells Docker that it should open an interactive container instance. 